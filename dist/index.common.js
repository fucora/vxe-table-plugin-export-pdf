"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginExportPDF = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

var _jspdf = _interopRequireDefault(require("jspdf"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/* eslint-disable no-unused-vars */

/* eslint-enable no-unused-vars */
var _vxetable;

function getFooterCellValue($table, opts, rows, column) {
  var cellValue = _xeUtils["default"].toString(rows[$table.$getColumnIndex(column)]);

  return cellValue;
}

function exportPDF(params) {
  var colWidth = 0;
  var options = params.options,
      columns = params.columns,
      datas = params.datas;
  var $table = params.$table;
  var treeConfig = $table.treeConfig,
      treeOpts = $table.treeOpts;
  var type = options.type,
      filename = options.filename,
      isHeader = options.isHeader,
      isFooter = options.isFooter,
      original = options.original,
      message = options.message,
      footerFilterMethod = options.footerFilterMethod;
  var footList = [];
  var headers = columns.map(function (column) {
    var title = _xeUtils["default"].toString(original ? column.property : column.getTitle()) || ' ';
    colWidth += column.renderWidth;
    return {
      name: column.id,
      prompt: title,
      width: column.renderWidth
    };
  });
  var rowList = [];
  var colRatio = colWidth / 100;
  headers.forEach(function (column) {
    column.width = Math.floor(column.width / colRatio * 4) - 1;
  });

  if (treeConfig) {
    rowList = datas.map(function (row) {
      var item = {};
      columns.forEach(function (column) {
        item[column.id] = column.treeNode ? ' '.repeat(row._level * treeOpts.indent / 8) + row[column.id] : row[column.id];
      });
      return item;
    });
  } else {
    rowList = datas;
  }

  if (isFooter) {
    var _$table$getTableData = $table.getTableData(),
        footerData = _$table$getTableData.footerData;

    var footers = footerFilterMethod ? footerData.filter(footerFilterMethod) : footerData;
    footers.forEach(function (rows) {
      var item = {};
      columns.forEach(function (column) {
        item[column.id] = getFooterCellValue($table, options, rows, column);
      });
      footList.push(item);
    });
  } // 转换pdf

  /* eslint-disable new-cap */


  var doc = new _jspdf["default"]({
    putOnlyUsedFonts: true,
    orientation: 'landscape'
  });
  doc.table(1, 1, rowList.concat(footList), headers, {
    printHeaders: isHeader,
    autoSize: false
  });
  doc.save("".concat(filename, ".").concat(type));

  if (message !== false) {
    _vxetable.modal.message({
      message: _vxetable.t('vxe.table.expSuccess'),
      status: 'success'
    });
  }
}

function handleExportEvent(params) {
  if (params.options.type === 'pdf') {
    exportPDF(params);
    return false;
  }
}
/**
 * 基于 vxe-table 表格的增强插件，支持导出 pdf 格式
 */


var VXETablePluginExportPDF = {
  install: function install(xtable) {
    var interceptor = xtable.interceptor;
    _vxetable = xtable;
    Object.assign(xtable.types, {
      pdf: 0
    });
    interceptor.mixin({
      'event.export': handleExportEvent
    });
  }
};
exports.VXETablePluginExportPDF = VXETablePluginExportPDF;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginExportPDF);
}

var _default = VXETablePluginExportPDF;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIl92eGV0YWJsZSIsImdldEZvb3RlckNlbGxWYWx1ZSIsIiR0YWJsZSIsIm9wdHMiLCJyb3dzIiwiY29sdW1uIiwiY2VsbFZhbHVlIiwiWEVVdGlscyIsInRvU3RyaW5nIiwiJGdldENvbHVtbkluZGV4IiwiZXhwb3J0UERGIiwicGFyYW1zIiwiY29sV2lkdGgiLCJvcHRpb25zIiwiY29sdW1ucyIsImRhdGFzIiwidHJlZUNvbmZpZyIsInRyZWVPcHRzIiwidHlwZSIsImZpbGVuYW1lIiwiaXNIZWFkZXIiLCJpc0Zvb3RlciIsIm9yaWdpbmFsIiwibWVzc2FnZSIsImZvb3RlckZpbHRlck1ldGhvZCIsImZvb3RMaXN0IiwiaGVhZGVycyIsIm1hcCIsInRpdGxlIiwicHJvcGVydHkiLCJnZXRUaXRsZSIsInJlbmRlcldpZHRoIiwibmFtZSIsImlkIiwicHJvbXB0Iiwid2lkdGgiLCJyb3dMaXN0IiwiY29sUmF0aW8iLCJmb3JFYWNoIiwiTWF0aCIsImZsb29yIiwicm93IiwiaXRlbSIsInRyZWVOb2RlIiwicmVwZWF0IiwiX2xldmVsIiwiaW5kZW50IiwiZ2V0VGFibGVEYXRhIiwiZm9vdGVyRGF0YSIsImZvb3RlcnMiLCJmaWx0ZXIiLCJwdXNoIiwiZG9jIiwianNQREYiLCJwdXRPbmx5VXNlZEZvbnRzIiwib3JpZW50YXRpb24iLCJ0YWJsZSIsImNvbmNhdCIsInByaW50SGVhZGVycyIsImF1dG9TaXplIiwic2F2ZSIsIm1vZGFsIiwidCIsInN0YXR1cyIsImhhbmRsZUV4cG9ydEV2ZW50IiwiVlhFVGFibGVQbHVnaW5FeHBvcnRQREYiLCJpbnN0YWxsIiwieHRhYmxlIiwiaW50ZXJjZXB0b3IiLCJPYmplY3QiLCJhc3NpZ24iLCJ0eXBlcyIsInBkZiIsIm1peGluIiwid2luZG93IiwiVlhFVGFibGUiLCJ1c2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFRQTs7OztBQVRBOztBQVVBO0FBRUEsSUFBSUEsU0FB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Y2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtdmFycyAqL1xyXG5pbXBvcnQgWEVVdGlscyBmcm9tICd4ZS11dGlscy9tZXRob2RzL3hlLXV0aWxzJ1xyXG5pbXBvcnQge1xyXG4gIFZYRVRhYmxlLFxyXG4gIFRhYmxlLFxyXG4gIEludGVyY2VwdG9yRXhwb3J0UGFyYW1zLFxyXG4gIENvbHVtbkNvbmZpZyxcclxuICBFeHBvcnRPcHRvbnNcclxufSBmcm9tICd2eGUtdGFibGUvbGliL3Z4ZS10YWJsZSdcclxuaW1wb3J0IGpzUERGIGZyb20gJ2pzcGRmJ1xyXG4vKiBlc2xpbnQtZW5hYmxlIG5vLXVudXNlZC12YXJzICovXHJcblxyXG5sZXQgX3Z4ZXRhYmxlOiB0eXBlb2YgVlhFVGFibGVcclxuXHJcbmZ1bmN0aW9uIGdldEZvb3RlckNlbGxWYWx1ZSAoJHRhYmxlOiBUYWJsZSwgb3B0czogRXhwb3J0T3B0b25zLCByb3dzOiBhbnlbXSwgY29sdW1uOiBDb2x1bW5Db25maWcpIHtcclxuICBjb25zdCBjZWxsVmFsdWUgPSBYRVV0aWxzLnRvU3RyaW5nKHJvd3NbJHRhYmxlLiRnZXRDb2x1bW5JbmRleChjb2x1bW4pXSlcclxuICByZXR1cm4gY2VsbFZhbHVlXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV4cG9ydFBERiAocGFyYW1zOiBJbnRlcmNlcHRvckV4cG9ydFBhcmFtcykge1xyXG4gIGxldCBjb2xXaWR0aCA9IDBcclxuICBjb25zdCB7IG9wdGlvbnMsIGNvbHVtbnMsIGRhdGFzIH0gPSBwYXJhbXNcclxuICBjb25zdCAkdGFibGU6IGFueSA9IHBhcmFtcy4kdGFibGVcclxuICBjb25zdCB7IHRyZWVDb25maWcsIHRyZWVPcHRzIH0gPSAkdGFibGVcclxuICBjb25zdCB7IHR5cGUsIGZpbGVuYW1lLCBpc0hlYWRlciwgaXNGb290ZXIsIG9yaWdpbmFsLCBtZXNzYWdlLCBmb290ZXJGaWx0ZXJNZXRob2QgfSA9IG9wdGlvbnNcclxuICBjb25zdCBmb290TGlzdDogeyBba2V5OiBzdHJpbmddOiBhbnkgfVtdID0gW11cclxuICBjb25zdCBoZWFkZXJzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9W10gPSBjb2x1bW5zLm1hcCgoY29sdW1uKSA9PiB7XHJcbiAgICBjb25zdCB0aXRsZTogc3RyaW5nID0gWEVVdGlscy50b1N0cmluZyhvcmlnaW5hbCA/IGNvbHVtbi5wcm9wZXJ0eSA6IGNvbHVtbi5nZXRUaXRsZSgpKSB8fCAnICdcclxuICAgIGNvbFdpZHRoICs9IGNvbHVtbi5yZW5kZXJXaWR0aFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogY29sdW1uLmlkLFxyXG4gICAgICBwcm9tcHQ6IHRpdGxlLFxyXG4gICAgICB3aWR0aDogY29sdW1uLnJlbmRlcldpZHRoXHJcbiAgICB9XHJcbiAgfSlcclxuICBsZXQgcm93TGlzdDogeyBba2V5OiBzdHJpbmddOiBhbnkgfVtdID0gW11cclxuICBjb25zdCBjb2xSYXRpbyA9IGNvbFdpZHRoIC8gMTAwXHJcbiAgaGVhZGVycy5mb3JFYWNoKChjb2x1bW4pID0+IHtcclxuICAgIGNvbHVtbi53aWR0aCA9IE1hdGguZmxvb3IoY29sdW1uLndpZHRoIC8gY29sUmF0aW8gKiA0KSAtIDFcclxuICB9KVxyXG4gIGlmICh0cmVlQ29uZmlnKSB7XHJcbiAgICByb3dMaXN0ID0gZGF0YXMubWFwKChyb3cpID0+IHtcclxuICAgICAgY29uc3QgaXRlbTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9IHt9XHJcbiAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XHJcbiAgICAgICAgaXRlbVtjb2x1bW4uaWRdID0gY29sdW1uLnRyZWVOb2RlID8gKCcgJy5yZXBlYXQocm93Ll9sZXZlbCAqIHRyZWVPcHRzLmluZGVudCAvIDgpICsgcm93W2NvbHVtbi5pZF0pIDogcm93W2NvbHVtbi5pZF1cclxuICAgICAgfSlcclxuICAgICAgcmV0dXJuIGl0ZW1cclxuICAgIH0pXHJcbiAgfSBlbHNlIHtcclxuICAgIHJvd0xpc3QgPSBkYXRhc1xyXG4gIH1cclxuICBpZiAoaXNGb290ZXIpIHtcclxuICAgIGNvbnN0IHsgZm9vdGVyRGF0YSB9ID0gJHRhYmxlLmdldFRhYmxlRGF0YSgpXHJcbiAgICBjb25zdCBmb290ZXJzID0gZm9vdGVyRmlsdGVyTWV0aG9kID8gZm9vdGVyRGF0YS5maWx0ZXIoZm9vdGVyRmlsdGVyTWV0aG9kKSA6IGZvb3RlckRhdGFcclxuICAgIGZvb3RlcnMuZm9yRWFjaCgocm93czogYW55W10pID0+IHtcclxuICAgICAgY29uc3QgaXRlbTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9IHt9XHJcbiAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XHJcbiAgICAgICAgaXRlbVtjb2x1bW4uaWRdID0gZ2V0Rm9vdGVyQ2VsbFZhbHVlKCR0YWJsZSwgb3B0aW9ucywgcm93cywgY29sdW1uKVxyXG4gICAgICB9KVxyXG4gICAgICBmb290TGlzdC5wdXNoKGl0ZW0pXHJcbiAgICB9KVxyXG4gIH1cclxuICAvLyDovazmjaJwZGZcclxuICAvKiBlc2xpbnQtZGlzYWJsZSBuZXctY2FwICovXHJcbiAgY29uc3QgZG9jID0gbmV3IGpzUERGKHsgcHV0T25seVVzZWRGb250czogdHJ1ZSwgb3JpZW50YXRpb246ICdsYW5kc2NhcGUnIH0pXHJcbiAgZG9jLnRhYmxlKDEsIDEsIHJvd0xpc3QuY29uY2F0KGZvb3RMaXN0KSwgaGVhZGVycywgeyBwcmludEhlYWRlcnM6IGlzSGVhZGVyLCBhdXRvU2l6ZTogZmFsc2UgfSlcclxuICBkb2Muc2F2ZShgJHtmaWxlbmFtZX0uJHt0eXBlfWApXHJcbiAgaWYgKG1lc3NhZ2UgIT09IGZhbHNlKSB7XHJcbiAgICBfdnhldGFibGUubW9kYWwubWVzc2FnZSh7IG1lc3NhZ2U6IF92eGV0YWJsZS50KCd2eGUudGFibGUuZXhwU3VjY2VzcycpLCBzdGF0dXM6ICdzdWNjZXNzJyB9KVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXhwb3J0RXZlbnQgKHBhcmFtczogSW50ZXJjZXB0b3JFeHBvcnRQYXJhbXMpIHtcclxuICBpZiAocGFyYW1zLm9wdGlvbnMudHlwZSA9PT0gJ3BkZicpIHtcclxuICAgIGV4cG9ydFBERihwYXJhbXMpXHJcbiAgICByZXR1cm4gZmFsc2VcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWinuW8uuaPkuS7tu+8jOaUr+aMgeWvvOWHuiBwZGYg5qC85byPXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgVlhFVGFibGVQbHVnaW5FeHBvcnRQREYgPSB7XHJcbiAgaW5zdGFsbCAoeHRhYmxlOiB0eXBlb2YgVlhFVGFibGUpIHtcclxuICAgIGNvbnN0IHsgaW50ZXJjZXB0b3IgfSA9IHh0YWJsZVxyXG4gICAgX3Z4ZXRhYmxlID0geHRhYmxlXHJcbiAgICBPYmplY3QuYXNzaWduKHh0YWJsZS50eXBlcywgeyBwZGY6IDAgfSlcclxuICAgIGludGVyY2VwdG9yLm1peGluKHtcclxuICAgICAgJ2V2ZW50LmV4cG9ydCc6IGhhbmRsZUV4cG9ydEV2ZW50XHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WWEVUYWJsZSkge1xyXG4gIHdpbmRvdy5WWEVUYWJsZS51c2UoVlhFVGFibGVQbHVnaW5FeHBvcnRQREYpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFZYRVRhYmxlUGx1Z2luRXhwb3J0UERGXHJcbiJdfQ==
