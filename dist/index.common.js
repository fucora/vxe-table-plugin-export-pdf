"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginExportPDF = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

var _jspdf = _interopRequireDefault(require("jspdf"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/* eslint-disable no-unused-vars */

/* eslint-enable no-unused-vars */
var _vxetable;

function getFooterCellValue($table, opts, rows, column) {
  var cellValue = _xeUtils["default"].toString(rows[$table.$getColumnIndex(column)]);

  return cellValue;
}

function exportPDF(params) {
  var colWidth = 0;
  var options = params.options,
      columns = params.columns,
      datas = params.datas;
  var $table = params.$table;
  var treeConfig = $table.treeConfig,
      treeOpts = $table.treeOpts;
  var type = options.type,
      filename = options.filename,
      isHeader = options.isHeader,
      isFooter = options.isFooter,
      original = options.original,
      message = options.message,
      footerFilterMethod = options.footerFilterMethod;
  var footList = [];
  var headers = columns.map(function (column) {
    var title = _xeUtils["default"].toString(original ? column.property : column.getTitle()) || ' ';
    colWidth += column.renderWidth;
    return {
      name: column.id,
      prompt: title,
      width: column.renderWidth
    };
  });
  var rowList = [];
  var colRatio = colWidth / 100;
  headers.forEach(function (column) {
    column.width = Math.floor(column.width / colRatio * 4) - 1;
  });

  if (treeConfig) {
    rowList = datas.map(function (row) {
      var item = {};
      columns.forEach(function (column) {
        item[column.id] = column.treeNode ? ' '.repeat(row._level * treeOpts.indent / 8) + row[column.id] : row[column.id];
      });
      return item;
    });
  } else {
    rowList = datas;
  }

  if (isFooter) {
    var _$table$getTableData = $table.getTableData(),
        footerData = _$table$getTableData.footerData;

    var footers = footerFilterMethod ? footerData.filter(footerFilterMethod) : footerData;
    footers.forEach(function (rows) {
      var item = {};
      columns.forEach(function (column) {
        item[column.id] = getFooterCellValue($table, options, rows, column);
      });
      footList.push(item);
    });
  } // 转换pdf

  /* eslint-disable new-cap */


  var doc = new _jspdf["default"]({
    putOnlyUsedFonts: true,
    orientation: 'landscape'
  });
  doc.table(1, 1, rowList.concat(footList), headers, {
    printHeaders: isHeader,
    autoSize: false
  });
  doc.save("".concat(filename, ".").concat(type));

  if (message !== false) {
    _vxetable.modal.message({
      message: _vxetable.t('vxe.table.expSuccess'),
      status: 'success'
    });
  }
}

function handleExportEvent(params) {
  if (params.options.type === 'pdf') {
    exportPDF(params);
    return false;
  }
}
/**
 * 基于 vxe-table 表格的增强插件，支持导出 pdf 格式
 */


var VXETablePluginExportPDF = {
  install: function install(xtable) {
    var interceptor = xtable.interceptor;
    _vxetable = xtable;
    Object.assign(xtable.types, {
      pdf: 0
    });
    interceptor.mixin({
      'event.export': handleExportEvent
    });
  }
};
exports.VXETablePluginExportPDF = VXETablePluginExportPDF;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginExportPDF);
}

var _default = VXETablePluginExportPDF;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbIl92eGV0YWJsZSIsImdldEZvb3RlckNlbGxWYWx1ZSIsIiR0YWJsZSIsIm9wdHMiLCJyb3dzIiwiY29sdW1uIiwiY2VsbFZhbHVlIiwiWEVVdGlscyIsInRvU3RyaW5nIiwiJGdldENvbHVtbkluZGV4IiwiZXhwb3J0UERGIiwicGFyYW1zIiwiY29sV2lkdGgiLCJvcHRpb25zIiwiY29sdW1ucyIsImRhdGFzIiwidHJlZUNvbmZpZyIsInRyZWVPcHRzIiwidHlwZSIsImZpbGVuYW1lIiwiaXNIZWFkZXIiLCJpc0Zvb3RlciIsIm9yaWdpbmFsIiwibWVzc2FnZSIsImZvb3RlckZpbHRlck1ldGhvZCIsImZvb3RMaXN0IiwiaGVhZGVycyIsIm1hcCIsInRpdGxlIiwicHJvcGVydHkiLCJnZXRUaXRsZSIsInJlbmRlcldpZHRoIiwibmFtZSIsImlkIiwicHJvbXB0Iiwid2lkdGgiLCJyb3dMaXN0IiwiY29sUmF0aW8iLCJmb3JFYWNoIiwiTWF0aCIsImZsb29yIiwicm93IiwiaXRlbSIsInRyZWVOb2RlIiwicmVwZWF0IiwiX2xldmVsIiwiaW5kZW50IiwiZ2V0VGFibGVEYXRhIiwiZm9vdGVyRGF0YSIsImZvb3RlcnMiLCJmaWx0ZXIiLCJwdXNoIiwiZG9jIiwianNQREYiLCJwdXRPbmx5VXNlZEZvbnRzIiwib3JpZW50YXRpb24iLCJ0YWJsZSIsImNvbmNhdCIsInByaW50SGVhZGVycyIsImF1dG9TaXplIiwic2F2ZSIsIm1vZGFsIiwidCIsInN0YXR1cyIsImhhbmRsZUV4cG9ydEV2ZW50IiwiVlhFVGFibGVQbHVnaW5FeHBvcnRQREYiLCJpbnN0YWxsIiwieHRhYmxlIiwiaW50ZXJjZXB0b3IiLCJPYmplY3QiLCJhc3NpZ24iLCJ0eXBlcyIsInBkZiIsIm1peGluIiwid2luZG93IiwiVlhFVGFibGUiLCJ1c2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFRQTs7OztBQVRBOztBQVVBO0FBRUEsSUFBSUEsU0FBSjs7QUFFQSxTQUFTQyxrQkFBVCxDQUE2QkMsTUFBN0IsRUFBNENDLElBQTVDLEVBQWdFQyxJQUFoRSxFQUE2RUMsTUFBN0UsRUFBaUc7QUFDL0YsTUFBSUMsU0FBUyxHQUFHQyxvQkFBUUMsUUFBUixDQUFpQkosSUFBSSxDQUFDRixNQUFNLENBQUNPLGVBQVAsQ0FBdUJKLE1BQXZCLENBQUQsQ0FBckIsQ0FBaEI7O0FBQ0EsU0FBT0MsU0FBUDtBQUNEOztBQUVELFNBQVNJLFNBQVQsQ0FBb0JDLE1BQXBCLEVBQW1EO0FBQ2pELE1BQUlDLFFBQVEsR0FBVyxDQUF2QjtBQURpRCxNQUV6Q0MsT0FGeUMsR0FFYkYsTUFGYSxDQUV6Q0UsT0FGeUM7QUFBQSxNQUVoQ0MsT0FGZ0MsR0FFYkgsTUFGYSxDQUVoQ0csT0FGZ0M7QUFBQSxNQUV2QkMsS0FGdUIsR0FFYkosTUFGYSxDQUV2QkksS0FGdUI7QUFHakQsTUFBTWIsTUFBTSxHQUFRUyxNQUFNLENBQUNULE1BQTNCO0FBSGlELE1BSXpDYyxVQUp5QyxHQUloQmQsTUFKZ0IsQ0FJekNjLFVBSnlDO0FBQUEsTUFJN0JDLFFBSjZCLEdBSWhCZixNQUpnQixDQUk3QmUsUUFKNkI7QUFBQSxNQUt6Q0MsSUFMeUMsR0FLcUNMLE9BTHJDLENBS3pDSyxJQUx5QztBQUFBLE1BS25DQyxRQUxtQyxHQUtxQ04sT0FMckMsQ0FLbkNNLFFBTG1DO0FBQUEsTUFLekJDLFFBTHlCLEdBS3FDUCxPQUxyQyxDQUt6Qk8sUUFMeUI7QUFBQSxNQUtmQyxRQUxlLEdBS3FDUixPQUxyQyxDQUtmUSxRQUxlO0FBQUEsTUFLTEMsUUFMSyxHQUtxQ1QsT0FMckMsQ0FLTFMsUUFMSztBQUFBLE1BS0tDLE9BTEwsR0FLcUNWLE9BTHJDLENBS0tVLE9BTEw7QUFBQSxNQUtjQyxrQkFMZCxHQUtxQ1gsT0FMckMsQ0FLY1csa0JBTGQ7QUFNakQsTUFBTUMsUUFBUSxHQUE2QixFQUEzQztBQUNBLE1BQU1DLE9BQU8sR0FBNkJaLE9BQU8sQ0FBQ2EsR0FBUixDQUFZLFVBQUN0QixNQUFELEVBQVc7QUFDL0QsUUFBTXVCLEtBQUssR0FBV3JCLG9CQUFRQyxRQUFSLENBQWlCYyxRQUFRLEdBQUdqQixNQUFNLENBQUN3QixRQUFWLEdBQXFCeEIsTUFBTSxDQUFDeUIsUUFBUCxFQUE5QyxLQUFvRSxHQUExRjtBQUNBbEIsSUFBQUEsUUFBUSxJQUFJUCxNQUFNLENBQUMwQixXQUFuQjtBQUNBLFdBQU87QUFDTEMsTUFBQUEsSUFBSSxFQUFFM0IsTUFBTSxDQUFDNEIsRUFEUjtBQUVMQyxNQUFBQSxNQUFNLEVBQUVOLEtBRkg7QUFHTE8sTUFBQUEsS0FBSyxFQUFFOUIsTUFBTSxDQUFDMEI7QUFIVCxLQUFQO0FBS0QsR0FSeUMsQ0FBMUM7QUFTQSxNQUFJSyxPQUFPLEdBQTZCLEVBQXhDO0FBQ0EsTUFBTUMsUUFBUSxHQUFHekIsUUFBUSxHQUFHLEdBQTVCO0FBQ0FjLEVBQUFBLE9BQU8sQ0FBQ1ksT0FBUixDQUFnQixVQUFDakMsTUFBRCxFQUFXO0FBQ3pCQSxJQUFBQSxNQUFNLENBQUM4QixLQUFQLEdBQWVJLElBQUksQ0FBQ0MsS0FBTCxDQUFXbkMsTUFBTSxDQUFDOEIsS0FBUCxHQUFlRSxRQUFmLEdBQTBCLENBQXJDLElBQTBDLENBQXpEO0FBQ0QsR0FGRDs7QUFHQSxNQUFJckIsVUFBSixFQUFnQjtBQUNkb0IsSUFBQUEsT0FBTyxHQUFHckIsS0FBSyxDQUFDWSxHQUFOLENBQVUsVUFBQ2MsR0FBRCxFQUFRO0FBQzFCLFVBQU1DLElBQUksR0FBMkIsRUFBckM7QUFDQTVCLE1BQUFBLE9BQU8sQ0FBQ3dCLE9BQVIsQ0FBZ0IsVUFBQ2pDLE1BQUQsRUFBVztBQUN6QnFDLFFBQUFBLElBQUksQ0FBQ3JDLE1BQU0sQ0FBQzRCLEVBQVIsQ0FBSixHQUFrQjVCLE1BQU0sQ0FBQ3NDLFFBQVAsR0FBbUIsSUFBSUMsTUFBSixDQUFXSCxHQUFHLENBQUNJLE1BQUosR0FBYTVCLFFBQVEsQ0FBQzZCLE1BQXRCLEdBQStCLENBQTFDLElBQStDTCxHQUFHLENBQUNwQyxNQUFNLENBQUM0QixFQUFSLENBQXJFLEdBQW9GUSxHQUFHLENBQUNwQyxNQUFNLENBQUM0QixFQUFSLENBQXpHO0FBQ0QsT0FGRDtBQUdBLGFBQU9TLElBQVA7QUFDRCxLQU5TLENBQVY7QUFPRCxHQVJELE1BUU87QUFDTE4sSUFBQUEsT0FBTyxHQUFHckIsS0FBVjtBQUNEOztBQUNELE1BQUlNLFFBQUosRUFBYztBQUFBLCtCQUNXbkIsTUFBTSxDQUFDNkMsWUFBUCxFQURYO0FBQUEsUUFDSkMsVUFESSx3QkFDSkEsVUFESTs7QUFFWixRQUFNQyxPQUFPLEdBQUd6QixrQkFBa0IsR0FBR3dCLFVBQVUsQ0FBQ0UsTUFBWCxDQUFrQjFCLGtCQUFsQixDQUFILEdBQTJDd0IsVUFBN0U7QUFDQUMsSUFBQUEsT0FBTyxDQUFDWCxPQUFSLENBQWdCLFVBQUNsQyxJQUFELEVBQWdCO0FBQzlCLFVBQU1zQyxJQUFJLEdBQTJCLEVBQXJDO0FBQ0E1QixNQUFBQSxPQUFPLENBQUN3QixPQUFSLENBQWdCLFVBQUNqQyxNQUFELEVBQVc7QUFDekJxQyxRQUFBQSxJQUFJLENBQUNyQyxNQUFNLENBQUM0QixFQUFSLENBQUosR0FBa0JoQyxrQkFBa0IsQ0FBQ0MsTUFBRCxFQUFTVyxPQUFULEVBQWtCVCxJQUFsQixFQUF3QkMsTUFBeEIsQ0FBcEM7QUFDRCxPQUZEO0FBR0FvQixNQUFBQSxRQUFRLENBQUMwQixJQUFULENBQWNULElBQWQ7QUFDRCxLQU5EO0FBT0QsR0ExQ2dELENBMkNqRDs7QUFDQTs7O0FBQ0EsTUFBTVUsR0FBRyxHQUFHLElBQUlDLGlCQUFKLENBQVU7QUFBRUMsSUFBQUEsZ0JBQWdCLEVBQUUsSUFBcEI7QUFBMEJDLElBQUFBLFdBQVcsRUFBRTtBQUF2QyxHQUFWLENBQVo7QUFDQUgsRUFBQUEsR0FBRyxDQUFDSSxLQUFKLENBQVUsQ0FBVixFQUFhLENBQWIsRUFBZ0JwQixPQUFPLENBQUNxQixNQUFSLENBQWVoQyxRQUFmLENBQWhCLEVBQTBDQyxPQUExQyxFQUFtRDtBQUFFZ0MsSUFBQUEsWUFBWSxFQUFFdEMsUUFBaEI7QUFBMEJ1QyxJQUFBQSxRQUFRLEVBQUU7QUFBcEMsR0FBbkQ7QUFDQVAsRUFBQUEsR0FBRyxDQUFDUSxJQUFKLFdBQVl6QyxRQUFaLGNBQXdCRCxJQUF4Qjs7QUFDQSxNQUFJSyxPQUFPLEtBQUssS0FBaEIsRUFBdUI7QUFDckJ2QixJQUFBQSxTQUFTLENBQUM2RCxLQUFWLENBQWdCdEMsT0FBaEIsQ0FBd0I7QUFBRUEsTUFBQUEsT0FBTyxFQUFFdkIsU0FBUyxDQUFDOEQsQ0FBVixDQUFZLHNCQUFaLENBQVg7QUFBZ0RDLE1BQUFBLE1BQU0sRUFBRTtBQUF4RCxLQUF4QjtBQUNEO0FBQ0Y7O0FBRUQsU0FBU0MsaUJBQVQsQ0FBNEJyRCxNQUE1QixFQUEyRDtBQUN6RCxNQUFJQSxNQUFNLENBQUNFLE9BQVAsQ0FBZUssSUFBZixLQUF3QixLQUE1QixFQUFtQztBQUNqQ1IsSUFBQUEsU0FBUyxDQUFDQyxNQUFELENBQVQ7QUFDQSxXQUFPLEtBQVA7QUFDRDtBQUNGO0FBRUQ7Ozs7O0FBR08sSUFBTXNELHVCQUF1QixHQUFHO0FBQ3JDQyxFQUFBQSxPQURxQyxtQkFDNUJDLE1BRDRCLEVBQ0w7QUFBQSxRQUN0QkMsV0FEc0IsR0FDTkQsTUFETSxDQUN0QkMsV0FEc0I7QUFFOUJwRSxJQUFBQSxTQUFTLEdBQUdtRSxNQUFaO0FBQ0FFLElBQUFBLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjSCxNQUFNLENBQUNJLEtBQXJCLEVBQTRCO0FBQUVDLE1BQUFBLEdBQUcsRUFBRTtBQUFQLEtBQTVCO0FBQ0FKLElBQUFBLFdBQVcsQ0FBQ0ssS0FBWixDQUFrQjtBQUNoQixzQkFBZ0JUO0FBREEsS0FBbEI7QUFHRDtBQVJvQyxDQUFoQzs7O0FBV1AsSUFBSSxPQUFPVSxNQUFQLEtBQWtCLFdBQWxCLElBQWlDQSxNQUFNLENBQUNDLFFBQTVDLEVBQXNEO0FBQ3BERCxFQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLEdBQWhCLENBQW9CWCx1QkFBcEI7QUFDRDs7ZUFFY0EsdUIiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cclxuaW1wb3J0IFhFVXRpbHMgZnJvbSAneGUtdXRpbHMvbWV0aG9kcy94ZS11dGlscydcclxuaW1wb3J0IHtcclxuICBWWEVUYWJsZSxcclxuICBUYWJsZSxcclxuICBJbnRlcmNlcHRvckV4cG9ydFBhcmFtcyxcclxuICBDb2x1bW5Db25maWcsXHJcbiAgRXhwb3J0T3B0b25zXHJcbn0gZnJvbSAndnhlLXRhYmxlL2xpYi92eGUtdGFibGUnXHJcbmltcG9ydCBqc1BERiBmcm9tICdqc3BkZidcclxuLyogZXNsaW50LWVuYWJsZSBuby11bnVzZWQtdmFycyAqL1xyXG5cclxubGV0IF92eGV0YWJsZTogdHlwZW9mIFZYRVRhYmxlXHJcblxyXG5mdW5jdGlvbiBnZXRGb290ZXJDZWxsVmFsdWUgKCR0YWJsZTogVGFibGUsIG9wdHM6IEV4cG9ydE9wdG9ucywgcm93czogYW55W10sIGNvbHVtbjogQ29sdW1uQ29uZmlnKSB7XHJcbiAgdmFyIGNlbGxWYWx1ZSA9IFhFVXRpbHMudG9TdHJpbmcocm93c1skdGFibGUuJGdldENvbHVtbkluZGV4KGNvbHVtbildKVxyXG4gIHJldHVybiBjZWxsVmFsdWVcclxufVxyXG5cclxuZnVuY3Rpb24gZXhwb3J0UERGIChwYXJhbXM6IEludGVyY2VwdG9yRXhwb3J0UGFyYW1zKSB7XHJcbiAgbGV0IGNvbFdpZHRoOiBudW1iZXIgPSAwXHJcbiAgY29uc3QgeyBvcHRpb25zLCBjb2x1bW5zLCBkYXRhcyB9ID0gcGFyYW1zXHJcbiAgY29uc3QgJHRhYmxlOiBhbnkgPSBwYXJhbXMuJHRhYmxlXHJcbiAgY29uc3QgeyB0cmVlQ29uZmlnLCB0cmVlT3B0cyB9ID0gJHRhYmxlXHJcbiAgY29uc3QgeyB0eXBlLCBmaWxlbmFtZSwgaXNIZWFkZXIsIGlzRm9vdGVyLCBvcmlnaW5hbCwgbWVzc2FnZSwgZm9vdGVyRmlsdGVyTWV0aG9kIH0gPSBvcHRpb25zXHJcbiAgY29uc3QgZm9vdExpc3Q6IHsgW2tleTogc3RyaW5nXTogYW55IH1bXSA9IFtdXHJcbiAgY29uc3QgaGVhZGVyczogeyBba2V5OiBzdHJpbmddOiBhbnkgfVtdID0gY29sdW1ucy5tYXAoKGNvbHVtbikgPT4ge1xyXG4gICAgY29uc3QgdGl0bGU6IHN0cmluZyA9IFhFVXRpbHMudG9TdHJpbmcob3JpZ2luYWwgPyBjb2x1bW4ucHJvcGVydHkgOiBjb2x1bW4uZ2V0VGl0bGUoKSkgfHwgJyAnXHJcbiAgICBjb2xXaWR0aCArPSBjb2x1bW4ucmVuZGVyV2lkdGhcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IGNvbHVtbi5pZCxcclxuICAgICAgcHJvbXB0OiB0aXRsZSxcclxuICAgICAgd2lkdGg6IGNvbHVtbi5yZW5kZXJXaWR0aFxyXG4gICAgfVxyXG4gIH0pXHJcbiAgbGV0IHJvd0xpc3Q6IHsgW2tleTogc3RyaW5nXTogYW55IH1bXSA9IFtdXHJcbiAgY29uc3QgY29sUmF0aW8gPSBjb2xXaWR0aCAvIDEwMFxyXG4gIGhlYWRlcnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XHJcbiAgICBjb2x1bW4ud2lkdGggPSBNYXRoLmZsb29yKGNvbHVtbi53aWR0aCAvIGNvbFJhdGlvICogNCkgLSAxXHJcbiAgfSlcclxuICBpZiAodHJlZUNvbmZpZykge1xyXG4gICAgcm93TGlzdCA9IGRhdGFzLm1hcCgocm93KSA9PiB7XHJcbiAgICAgIGNvbnN0IGl0ZW06IHsgW2tleTogc3RyaW5nXTogYW55IH0gPSB7fVxyXG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbHVtbikgPT4ge1xyXG4gICAgICAgIGl0ZW1bY29sdW1uLmlkXSA9IGNvbHVtbi50cmVlTm9kZSA/ICgnICcucmVwZWF0KHJvdy5fbGV2ZWwgKiB0cmVlT3B0cy5pbmRlbnQgLyA4KSArIHJvd1tjb2x1bW4uaWRdKSA6IHJvd1tjb2x1bW4uaWRdXHJcbiAgICAgIH0pXHJcbiAgICAgIHJldHVybiBpdGVtXHJcbiAgICB9KVxyXG4gIH0gZWxzZSB7XHJcbiAgICByb3dMaXN0ID0gZGF0YXNcclxuICB9XHJcbiAgaWYgKGlzRm9vdGVyKSB7XHJcbiAgICBjb25zdCB7IGZvb3RlckRhdGEgfSA9ICR0YWJsZS5nZXRUYWJsZURhdGEoKVxyXG4gICAgY29uc3QgZm9vdGVycyA9IGZvb3RlckZpbHRlck1ldGhvZCA/IGZvb3RlckRhdGEuZmlsdGVyKGZvb3RlckZpbHRlck1ldGhvZCkgOiBmb290ZXJEYXRhXHJcbiAgICBmb290ZXJzLmZvckVhY2goKHJvd3M6IGFueVtdKSA9PiB7XHJcbiAgICAgIGNvbnN0IGl0ZW06IHsgW2tleTogc3RyaW5nXTogYW55IH0gPSB7fVxyXG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbHVtbikgPT4ge1xyXG4gICAgICAgIGl0ZW1bY29sdW1uLmlkXSA9IGdldEZvb3RlckNlbGxWYWx1ZSgkdGFibGUsIG9wdGlvbnMsIHJvd3MsIGNvbHVtbilcclxuICAgICAgfSlcclxuICAgICAgZm9vdExpc3QucHVzaChpdGVtKVxyXG4gICAgfSlcclxuICB9XHJcbiAgLy8g6L2s5o2icGRmXHJcbiAgLyogZXNsaW50LWRpc2FibGUgbmV3LWNhcCAqL1xyXG4gIGNvbnN0IGRvYyA9IG5ldyBqc1BERih7IHB1dE9ubHlVc2VkRm9udHM6IHRydWUsIG9yaWVudGF0aW9uOiAnbGFuZHNjYXBlJyB9KVxyXG4gIGRvYy50YWJsZSgxLCAxLCByb3dMaXN0LmNvbmNhdChmb290TGlzdCksIGhlYWRlcnMsIHsgcHJpbnRIZWFkZXJzOiBpc0hlYWRlciwgYXV0b1NpemU6IGZhbHNlIH0pXHJcbiAgZG9jLnNhdmUoYCR7ZmlsZW5hbWV9LiR7dHlwZX1gKVxyXG4gIGlmIChtZXNzYWdlICE9PSBmYWxzZSkge1xyXG4gICAgX3Z4ZXRhYmxlLm1vZGFsLm1lc3NhZ2UoeyBtZXNzYWdlOiBfdnhldGFibGUudCgndnhlLnRhYmxlLmV4cFN1Y2Nlc3MnKSwgc3RhdHVzOiAnc3VjY2VzcycgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUV4cG9ydEV2ZW50IChwYXJhbXM6IEludGVyY2VwdG9yRXhwb3J0UGFyYW1zKSB7XHJcbiAgaWYgKHBhcmFtcy5vcHRpb25zLnR5cGUgPT09ICdwZGYnKSB7XHJcbiAgICBleHBvcnRQREYocGFyYW1zKVxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog5Z+65LqOIHZ4ZS10YWJsZSDooajmoLznmoTlop7lvLrmj5Lku7bvvIzmlK/mjIHlr7zlh7ogcGRmIOagvOW8j1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFZYRVRhYmxlUGx1Z2luRXhwb3J0UERGID0ge1xyXG4gIGluc3RhbGwgKHh0YWJsZTogdHlwZW9mIFZYRVRhYmxlKSB7XHJcbiAgICBjb25zdCB7IGludGVyY2VwdG9yIH0gPSB4dGFibGVcclxuICAgIF92eGV0YWJsZSA9IHh0YWJsZVxyXG4gICAgT2JqZWN0LmFzc2lnbih4dGFibGUudHlwZXMsIHsgcGRmOiAwIH0pXHJcbiAgICBpbnRlcmNlcHRvci5taXhpbih7XHJcbiAgICAgICdldmVudC5leHBvcnQnOiBoYW5kbGVFeHBvcnRFdmVudFxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuVlhFVGFibGUpIHtcclxuICB3aW5kb3cuVlhFVGFibGUudXNlKFZYRVRhYmxlUGx1Z2luRXhwb3J0UERGKVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBWWEVUYWJsZVBsdWdpbkV4cG9ydFBERlxyXG4iXX0=
